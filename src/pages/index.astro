---
import { DarkModeToggle } from "@/components/DarkModeSwitch";
import Intro from "../components/Intro.astro";
import Layout from "../layouts/Layout.astro";
import "@/styles/global.css";
import Contact from "@/components/Contact.astro";
import Work from "@/components/Work.astro";
import CurrentStack from "@/components/CurrentStack.astro";
import AboutMe from "@/components/AboutMe.astro";
import Designs from "@/components/Designs.astro";
import Overtake from "@/components/Overtake.astro";
---

<Layout title="Welcome to Astro.">
  <main
    class="mx-auto max-w-[calc(100%-2rem)] p-4 md:w-[736px] lg:w-[992px] xl:w-[1120px]"
  >
    <div class="bento grid grid-cols-8 gap-4 lg:grid-cols-12 lg:gap-8">
      <!-- Left grid -->
      <div
        class="col-span-5 grid auto-rows-min grid-cols-10 gap-4 lg:col-span-5 lg:gap-8"
      >
        <div class="col-span-10">
          <Intro />
        </div>

        <div class="col-span-10 flex flex-col gap-4 lg:gap-8">
          <div class="flex gap-4 lg:gap-8"><Work /></div>
          <AboutMe />
        </div>

        <div class="col-span-10 h-[234px]">
          <Designs />
        </div>
      </div>

      <!-- Right grid -->
      <div
        class="col-span-3 grid auto-rows-min grid-cols-10 gap-4 lg:col-span-7 lg:gap-8"
      >
        <!-- Avatar -->
        <div
          class="col-span-10 h-[280px] rounded-2xl bg-neutral-900 bg-cover bg-center shadow-md lg:col-span-5 lg:h-[190px] dark:shadow-none"
          style="background-image: url('https://khtaejonhhmqumbcfahq.supabase.co/storage/v1/object/public/portfolio/XT308664.jpg?t=2024-08-16T00%3A18%3A09.503Z')"
        >
        </div>

        <div class="col-span-10 flex flex-col gap-4 lg:col-span-5 lg:gap-8">
          <Contact />
        </div>

        <div class="col-span-10 flex flex-col lg:col-span-6">
          <CurrentStack />
        </div>

        <div class="col-span-4 hidden h-[224px] lg:block">
          <DarkModeToggle client:load />
        </div>

        <div class="col-span-10 hidden lg:block">
          <Overtake />
        </div>
      </div>
    </div>
    <div class="mt-4 w-full lg:hidden">
      <Overtake />
    </div>

    <style>
      /* .bento {
        display: grid;
        gap: 32px;
        grid-template-columns: repeat(12, 1fr);
      } */
    </style>
  </main>
</Layout>

<script is:inline>
  const getThemePreference = () => {
    if (typeof localStorage !== "undefined" && localStorage.getItem("theme")) {
      return localStorage.getItem("theme");
    }
    return window.matchMedia("(prefers-color-scheme: dark)").matches
      ? "dark"
      : "light";
  };
  const isDark = getThemePreference() === "dark";
  document.documentElement.classList[isDark ? "add" : "remove"]("dark");

  if (typeof localStorage !== "undefined") {
    const observer = new MutationObserver(() => {
      const isDark = document.documentElement.classList.contains("dark");
      localStorage.setItem("theme", isDark ? "dark" : "light");
    });
    observer.observe(document.documentElement, {
      attributes: true,
      attributeFilter: ["class"],
    });
  }
</script>
